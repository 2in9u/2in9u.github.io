---
#layout: posts
excerpt: ""
title: "[DirectX12] ğŸ“‚. Scene"
categories:
    - dx12
# tag:
# Â  Â  [cpp, c++, oop]
toc_label: "ëª©ì°¨"
toc: true
toc_sticky: true
date: 2023-02-18
last_modified_at: 2023-02-18

#published: false
---

# ğŸ”· Scene

---

## 1. Scene Class
- ì—¬ëŸ¬ GameObjectë¥¼ í¬í•¨í•˜ëŠ” í´ë˜ìŠ¤  

```cpp
class Scene
{
...
private:
	vector<shared_ptr<GameObject>>	_gameObjects;
};
```

<br>

## 2. SceneManager Class
- í˜„ì¬ í™œì„±í™”ë˜ì–´ ìˆëŠ”(í™”ë©´ì— ë³´ì—¬ì§€ëŠ”) Sceneì„ ê´€ë¦¬í•˜ëŠ” í´ë˜ìŠ¤  
- í™œì„±í™”ëœ sceneì´ í¬í•¨í•˜ëŠ” ëª¨ë“  gameObjectë“¤ì„ ë Œë”ë§í•œë‹¤.

```cpp
class SceneManager
{
public:
	void Update();
	void LoadScene(wstring sceneName);

...

private:
	shared_ptr<Scene> _activeScene;
};
```

```cpp
void SceneManager::Update()
{
	if (_activeScene == nullptr)
		return;

	_activeScene->Update();
	_activeScene->LateUpdate();
}

void SceneManager::LoadScene(wstring sceneName)
{
	// TODO : ê¸°ì¡´ Scene ì •ë¦¬
	// TODO : íŒŒì¼ì—ì„œ Scene ì •ë³´ ë¡œë“œ

	_activeScene = LoadTestScene();

	_activeScene->Awake();
	_activeScene->Start();
}
```

<br>

# ğŸ”· SceneManagerë¥¼ ì‚¬ìš©í•œ ë Œë”ë§ íë¦„

1) gameì„ ìµœê¸°í™” í•œ í›„, ë§¤ í”„ë ˆì„ë§ˆë‹¤ gameì´ Updateëœë‹¤.

```cpp
unique_ptr<Game> game = make_unique<Game>();
game->Init(windowInfo);

while (true)
{
    if (PeekMessage(&msg, nullptr, 0, 0, PM_REMOVE))
    {
        if (!TranslateAccelerator(msg.hwnd, hAccelTable, &msg))
        {
            TranslateMessage(&msg);
            DispatchMessage(&msg);
        }
    }

    // TODO
    game->Update();
}
```

2) Game::Init() í•  ë•Œ, í…ŒìŠ¤íŠ¸ìš© SceneManagerë¥¼ ë“±ë¡í•´ ë†“ì•˜ìœ¼ë©°, Game::Update() ë  ë•Œ ë§ˆë‹¤ Engine::Update()ë¥¼ í˜¸ì¶œí•œë‹¤.

```cpp
void Game::Init(WindowInfo& window)
{
	MyEngine->Init(window);
	SceneManager::GetInstance()->LoadScene(L"TestScene");	
}

void Game::Update()
{
	MyEngine->Update();
}
```

3) Engine::Update()ê°€ Engine::Render()ë¥¼ í˜¸ì¶œí•œë‹¤.

```cpp
void Engine::Update()
{
	Render();
}
```

4) Engine::Render()ì—ì„  ë Œë”ë§ì„ ìœ„í•œ ì „Â·í›„ì²˜ë¦¬ì™€ SceneManagerë¥¼ Updateì‹œì¼œì¤€ë‹¤.

```cpp
void Engine::Render()
{
	Start();

	SceneManager::GetInstance()->Update();

	End();
}
```

5) SceneManager::Update()ë¥¼ í†µí•´ í™œì„±í™” ëœ Sceneì„ Updateì‹œì¼œì¤€ë‹¤.

```cpp
void SceneManager::Update()
{
	if (_activeScene == nullptr)
		return;

	_activeScene->Update();
}
```

6) Scene::Update()ì—ì„œ Sceneì— í¬í•¨ë˜ì–´ìˆëŠ” ëª¨ë“  gameObjectë“¤ì„ Updateì‹œí‚¨ë‹¤.

```cpp
void Scene::Update()
{
	for (shared_ptr<GameObject> gameObject : _gameObjects)
		gameObject->Update(); // gameObjectë“¤ì˜ ë Œë”ë§ëª…ë ¹ì´ ëª…ë ¹ëª©ë¡ì— ì¶”ê°€ë˜ì–´ ê·¸ë ¤ì§„ë‹¤.
}
```

<br>

# ğŸ“‘. ì°¸ê³ 
* [Rookiss. [C++ê³¼ ì–¸ë¦¬ì–¼ë¡œ ë§Œë“œëŠ” MMORPG ê²Œì„ ê°œë°œ ì‹œë¦¬ì¦ˆ]Part2: ê²Œì„ ìˆ˜í•™ê³¼ DirectX12. Inflearn.](https://www.inflearn.com/course/%EC%96%B8%EB%A6%AC%EC%96%BC-3d-mmorpg-2/dashboard)
* [í”„ë­í¬ D. ë£¨ë‚˜(2020). DirectX 12ë¥¼ ì´ìš©í•œ 3Dê²Œì„ í”„ë¡œê·¸ë˜ë° ì…ë¬¸. í•œë¹›ë¯¸ë””ì–´(ì£¼).](https://www.hanbit.co.kr/store/books/look.php?p_code=B5088646371)