---
#layout: posts
excerpt: ""
title: "[Mvvm] ğŸ“‚. Inversion of Control (Ioc)"

categories:
  - mstoolkit_mvvm

toc_label: "ëª©ì°¨"
toc: true
toc_sticky: true

date: 2022-01-16
last-modified_at: 2022-01-16

#published: false
---

# 1. Microsoft.Toolkit.Mvvm.DependenctInjection
- ViewModel ìƒì„±ìì— ëŒ€í•œ ë§¤ê°œë³€ìˆ˜ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì „ë‹¬ í•  ë•Œ `ì¢…ì†ì„± ì£¼ì…(Dependency Injection`ì„ ì‚¬ìš©í•œë‹¤.
  > **ì¢…ì†ì„± ì£¼ì…**(Dependency Injection) : ì™¸ë¶€ì—ì„œ ë‘ ê°ì²´ ê°„ì˜ ê´€ê³„ë¥¼ ê²°ì •í•´ ì£¼ëŠ” ë””ìì¸
- ì¶”ìƒí™” í•œ ì„œë¹„ìŠ¤ë¥¼ í•„ìš”í•œ ê³³ì— ì£¼ì…í•˜ì—¬ ë°±ì—”ë“œ ì½”ë“œì—ì„œ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- Mvvm Toolkitì—ì„œëŠ” Ioc êµ¬í˜„ì„ ìœ„í•œ APIë¥¼ ì œê³µí•˜ì§€ ì•ŠëŠ”ë‹¤. (ì•„ë˜ì˜ ë‘ íŒ¨í‚¤ì§€ë¥¼ NuGetì—ì„œ ë‹¤ìš´ë°›ì•„ ì‚¬ìš©í•œë‹¤.)
  - `Microsoft.Extensions.DependencyInjection`
  - `Microsoft.Extensions.DepencencyInjection.Abstractions`

<br>

# 2. ì‚¬ìš© ë°©ë²• 
## 1. í”„ë¡œê·¸ë¨ ì§„ì…ì ì— ì„ ì–¸ ë¶€ë¶„
```csharp
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Toolkit.Mvvm.DependencyInjection;

public static IServiceProvider serviceProvider;
// í”„ë¡œê·¸ë¨ ì´ˆê¸°í™” ë¶€ë¶„
{
  serviceProvider = ConfigureServides();
  // ì¢…ì†ì„±ì„ ê´€ë¦¬í•´ì£¼ëŠ” Iocì— ì‚¬ìš©í•  í´ë˜ìŠ¤ ë“¤ì„ ë“±ë¡í•´ì¤€ë‹¤.
  Ioc.Default.ConfigureServices(serviceProvider);
}

// ConfigureServices êµ¬í˜„
private static IServiceProvider ConfigureServides()
{
  var services = new ServiceCollection();
  // View, ViewModel, Model, App Context, Serveice ë“±ë¡
  // ...
  return services.BuildServiceProvider(validateScopes: true);
}
```
- ConfigureServicesì— ì‚¬ìš©í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ ì„ ì–¸í•œë‹¤. ì´ë•Œ, ì„œë¹„ìŠ¤ ìˆ˜ëª…ì„ ê³ ë ¤í•˜ì—¬ ì‚¬ìš©ì˜ë„ì— ë§ê²Œ ì„ ì–¸í•œë‹¤.
  1. `Transient` : ì„œë¹„ìŠ¤ ì»¨í…Œì´ë„ˆì—ì„œ ìš”ì²­í•  ë•Œ ë§ˆë‹¤ ìƒì„±
  2. `Scoped` : ë²”ìœ„ë¥¼ ì§€ì •í•  ë•Œ ë§ˆë‹¤ ë§Œë“¤ì–´ì§ (ë²”ìœ„ ì•ˆì—ì„œëŠ” ìœ ì¼)
  3. `Singletion` : ì²˜ìŒ ìš”ì²­ë  ë•Œ ìƒì„± í›„, ë™ì¼í•œ ì¸ìŠ¤í„´ìŠ¤ ì‚¬ìš©

<br>

## 2. ì¢…ì†ì„± ì£¼ì… ë¶€ë¶„
```csharp
public class TestClass1
{
  public TestClass1() {}
  // ...
}

// TestClass2ëŠ” TestClass1ì— ì¢…ì†ë˜ì–´ìˆë‹¤.
public class TestClass2
{
  private TestClass1 _testclass1;
  // ì°¸ì¡° í•  í´ë˜ìŠ¤ë¥¼ ìƒì„±ìì—ì„œ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ì•„ì¤€ë‹¤.
  public TestClass2(TestClass1 testclass1) 
  {
    this._testclass1 = testclass1;
    // ...
  }
  // ...
}
```

<br>

## 3. TestClass2 ìƒì„±í•˜ê¸°
```csharp
using Microsoft.Toolkit.Mvvm.DependencyInjection;
// TestClass ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
  TestClass2 tc2 = Ioc.Default.GetService<TestClass2>();
```
- ìƒì„± ì „, `ConfigureServides`ì— í´ë˜ìŠ¤ ë“±ë¡ì„ í•´ì•¼ ì˜¤ë¥˜ê°€ ë‚˜ì§€ ì•ŠëŠ”ë‹¤.

<br>

# ğŸ“‘. ì°¸ê³ 
* [Ioc(Inversion of control)](https://docs.microsoft.com/en-us/windows/communitytoolkit/mvvm/ioc)
* [.NETì—ì„œ ì¢…ì†ì„± ì£¼ì…](https://docs.microsoft.com/ko-kr/dotnet/core/extensions/dependency-injection)
* [Connor Park. MVVM Toolkit ì‚¬ìš© ê°€ì´ë“œ.](https://kaki104.tistory.com/674)