---
#layout: posts
excerpt: ""
title: "[C++] ğŸ“‚. ì–•ì€ ë³µì‚¬(Shallow Copy)ì™€ ê¹Šì€ ë³µì‚¬(Deep Copy)"

categories:
    - cpp
# tag:
#     [cpp, c++, oop]

toc_label: "ëª©ì°¨"
toc: true
toc_sticky: true

date: 2021-11-27
last_modified_at: 2021-11-27

#published: false
---

# 0. ê¸°ë³¸ ì…‹íŒ…
```c++
class Other
{
    public:
        Other() { cout << "Other()" << endl; }
        ~Other() {cout << "~Other()" << endl; }
};

class Base
{
    public:
        int value = 0xAA;
        Other* other = nullptr;
};

```

```c++
int main()
{
    Derived d1; // ì›ë³¸

    Derived d2 = d1; // ë³µì‚¬ ìƒì„±ì
    Derived d3(d1); // ë³µì‚¬ ìƒì„±ì

    Derived d4; // ê¸°ë³¸ ìƒì„±ì
    d4 = d1; // ë³µì‚¬ ëŒ€ì… ì—°ì‚°ì

    return 0;
}
```

<br>

# 1. ì–•ì€ ë³µì‚¬ (**Shallow Copy**)
- ë©¤ë²„ ë°ì´í„°ë¥¼ ë¹„íŠ¸ì—´ ë‹¨ìœ„ë¡œ `ë˜‘ê°™ì´` ë³µì‚¬ (ë©”ëª¨ë¦¬ ì˜ì—­ ê°’ì„ `ê·¸ëŒ€ë¡œ` ë³µì‚¬)

```c++
class Derived : public Base
{
    public:
        Derived() { other = new Other(); }
        ~Derived() { delete other; }
};
```

- &d1  
  ![image](../../assets/images/cpp_img/4_copy/c_d1_address.png)
- &d2  
  ![image](../../assets/images/cpp_img/4_copy/c_d2_address.png)
- &d3  
  ![image](../../assets/images/cpp_img/4_copy/c_d3_address.png)
- &d4  
  ![image](../../assets/images/cpp_img/4_copy/c_d4_address.png)
  > ê°™ì€ `ì£¼ì†Œê°’`ì„ `ê³µìœ `í•œë‹¤. 
  > ![image](../../assets/images/cpp_img/4_copy/shallow_copy.png)

<br>

- âš  ë¬¸ì œì 
  > ëª¨ë‘ ê°™ì€ ì£¼ì†Œë¥¼ ê°€ë¦¬í‚¤ê³  ìˆê¸° ë•Œë¬¸ì—, ê°’ì´ ë³€ê²½ë˜ëŠ” ê²½ìš°, d1, d2, d3, d4ì˜ ê°’ì´ ëª¨ë‘ ë³€ê²½ëœë‹¤.
  
<br>

# 2. ê¹Šì€ ë³µì‚¬ (**Deep Copy**)
- ë©¤ë²„ ë°ì´í„°ê°€ ì°¸ì¡°(ì£¼ì†Œ) ê°’ì´ë¼ë©´ ë°ì´í„°ë¥¼ ìƒˆë¡œ ìƒì„± (ì›ë³¸ ê°ì²´ê°€ ì°¸ì¡°í•˜ëŠ” ëŒ€ìƒê¹Œì§€ `ë§Œë“¤ì–´ì„œ` ë³µì‚¬)

```c++
class Other
{
    public:
        â€¦
        Other(const Other& o) { cout << "Other(const Other&)" << endl; }
        â€¦
};

class Derived : public Base
{
    public:
        â€¦
        Derived(const Derived& d)
        {
            value = d.value;
            other = new Other(*(d.other)); // ìƒˆë¡œìš´ ê°ì²´ ìƒì„±         
        }

        Derived& operator=(const Derived& d)
        {
            value = d.value;
            other = new Other(*(d.other)); // ìƒˆë¡œìš´ ê°ì²´ ìƒì„±
            return *this;
        }
        â€¦
};
```

- &d1  
  ![image](../../assets/images/cpp_img/4_copy/d_d1_address.png)
- &d2  
  ![image](../../assets/images/cpp_img/4_copy/d_d2_address.png)
- &d3  
  ![image](../../assets/images/cpp_img/4_copy/d_d3_address.png)
- &d4  
  ![image](../../assets/images/cpp_img/4_copy/d_d4_address.png)
  > `ë‹¤ë¥¸` ì£¼ì†Œê°’ì„ ê°€ì§„ë‹¤.
  > ![image](../../assets/images/cpp_img/4_copy/deep_copy.png)


<br>

# 3. í˜¸ì¶œ ìˆœì„œ
```c++
class Member
{
    public:
        Member() { cout << "Member()" << endl; }
        Member(const Member& m) { cout << "Member(const Member&)" << endl; }
        ~Member() { cout << "~Member()" << endl; }

        Member& operator= (const Member& m) 
        { 
            cout << "operator= (const Member&)" << endl; 
            return *this;
        }
};

class Base
{
    public:
        Base() { cout << "Base()" << endl; }
        Base(const Base& b) 
        { 
            cout << "Base(const Base&)" << endl;  
            num = b.num; 
        }
        ~Base() { cout << "~Base()" << endl; }

        Base& operator= (const Base& b) 
        { 
            cout << "operator(const Base&)" << endl; 
            num = b.num; 
            return *this; 
        }
    public:
        int num = 0;
};
```

<br>

## 1. ë³µì‚¬ ìƒì„±ì
### 1. **ì•”ì‹œì  ë³µì‚¬ ìƒì„±ì** ìˆœì„œ  
   1) `ê¸°ë³¸` í´ë˜ìŠ¤ì˜ ë³µì‚¬ ìƒì„±ì í˜¸ì¶œ  
   2) `ë©¤ë²„` í´ë˜ìŠ¤ì˜ ë³µì‚¬ ìƒì„±ì í˜¸ì¶œ  
   3) ë©¤ë²„ê°€ ê¸°ë³¸ íƒ€ì…ì¼ ê²½ìš° ë©”ëª¨ë¦¬ ë³µì‚¬ (`ì–•ì€ ë³µì‚¬`)  
   
```c++
class Derived : public Base
{
    public:
        Derived() { cout << "Derived()" << endl; }
        ~Derived() { cout << "~Derived()" << endl; }
    public:
        Member m; 
};
```

 - ê²°ê³¼  
 ![image](../../assets/images/cpp_img/4_copy/implicit_copy_constructor.png)

<br>

### 2. **ëª…ì‹œì  ë³µì‚¬ ìƒì„±ì** ìˆœì„œ  
   1) `ê¸°ë³¸` í´ë˜ìŠ¤ì˜ ê¸°ë³¸ ìƒì„±ì í˜¸ì¶œ  
   2) `ë©¤ë²„` í´ë˜ìŠ¤ì˜ ê¸°ë³¸ ìƒì„±ì í˜¸ì¶œ  
   > ë¶€ëª¨, ë©¤ë²„ í´ë˜ìŠ¤ ê°’ì´ **ë³µì‚¬ë˜ì§€ ì•ŠëŠ”ë‹¤**.  
   > ëª¨ë“  ë³µì‚¬ì˜ ì±…ì„ì€ í”„ë¡œê·¸ë˜ë¨¸ê°€ ê°€ì§„ë‹¤.  

```c++
class Derived : public Base
{
    public:
        Derived() { cout << "Derived()" << endl; }
        ~Derived() { cout << "~Derived()" << endl; }

        Derived(const Derived& d) {cout << "Derived(const Derived&)" << endl; }
    public:
        Member m; 
};
```

 - ê²°ê³¼  
 ![image](../../assets/images/cpp_img/4_copy/explicit_copy_constructor1.png)
 - âš  ë¬¸ì œì  
     > ë¶€ëª¨, ë©¤ë²„ í´ë˜ìŠ¤ì˜ ê¸°ë³¸ ìƒì„±ì í˜¸ì¶œ  
     > ë¶€ëª¨, ë©¤ë²„ í´ë˜ìŠ¤ì˜ ê°’ì´ ë³µì‚¬ë˜ì§€ ì•ŠëŠ”ë‹¤  

 - ë¶€ëª¨, ë©¤ë²„ í´ë˜ìŠ¤ ìƒì„±ì ì§€ì •
     ```c++
     class Derived : public Base
     {
         public:
             Derived() { cout << "Derived()" << endl; }
             ~Derived() { cout << "~Derived()" << endl; }

             Derived(const Derived& d) : Base(d), m(d.m) // ìƒì„±ì ì§€ì • í•„ìš”
             {
                 cout << "Derived(const Derived&)" << endl; 
             }
         public:
             Member m; 
     };
     ```
 - ê²°ê³¼  
 ![image](../../assets/images/cpp_img/4_copy/explicit_copy_constructor2.png)

<br>

## 2. ë³µì‚¬ ëŒ€ì… ì—°ì‚°ì  
### 1. **ì•”ì‹œì  ë³µì‚¬ ëŒ€ì… ì—°ì‚°ì** ìˆœì„œ  
   1) `ê¸°ë³¸` í´ë˜ìŠ¤ì˜ ë³µì‚¬ ëŒ€ì… ì—°ì‚°ì í˜¸ì¶œ  
   2) `íŒŒìƒ` í´ë˜ìŠ¤ì˜ ë³µì‚¬ ëŒ€ì… ì—°ì‚°ì í˜¸ì¶œ  
   3) ë©¤ë²„ê°€ ê¸°ë³¸ íƒ€ì…ì¼ ê²½ìš° ë©”ëª¨ë¦¬ ë³µì‚¬ (`ì–•ì€ ë³µì‚¬`)  

```c++
class Derived : public Base
{
    public:
        Derived() { cout << "Derived()" << endl; }
        ~Derived() { cout << "~Derived()" << endl; }
    public:
        Member m; 
};
```
- ê²°ê³¼  
![image](../../assets/images/cpp_img/4_copy/implicit_copy_operator.png)

<br>

### 2. **ëª…ì‹œì  ë³µì‚¬ ëŒ€ì… ì—°ì‚°ì** ìˆœì„œ  
   \- ì•Œì•„ì„œ í•´ì£¼ëŠ” ê²ƒ ì—†ìŒ  
```c++
class Derived : public Base
{
    public:
        Derived() { cout << "Derived()" << endl; }
        ~Derived() { cout << "~Derived()" << endl; }

        Derived& operator= (const Derived& d)
        {
            cout << "Derived(const Derived&)" << endl;
            return *this;
        }
    public:
        Member m; 
};
```
- ê²°ê³¼  
![image](../../assets/images/cpp_img/4_copy/explicit_copy_operator.png)

<br>

# ğŸ“‘. ì°¸ê³ 
* [í™©ê¸°íƒœ(2013). (ëª…í’ˆ)C++ Programming. íŒŒì£¼:ìƒëŠ¥ì¶œíŒì‚¬.](https://www.booksr.co.kr/html/book/book.asp?seq=697053)
* [Rookiss. [C++ê³¼ ì–¸ë¦¬ì–¼ë¡œ ë§Œë“œëŠ” MMORPG ê²Œì„ ê°œë°œ ì‹œë¦¬ì¦ˆ]Part1: C++ í”„ë¡œê·¸ë˜ë° ì…ë¬¸. Inflearn.](https://www.inflearn.com/course/%EC%96%B8%EB%A6%AC%EC%96%BC-3d-mmorpg-1/dashboard)

